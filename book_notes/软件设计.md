# 软件设计是什么
1. 软件设计就是构建出一套模型
2. 需要规范来约束软件设计

# 分离关注点
1. 技术与业务分离
2. 不同的数据变动方向

# 可测试性
- 软件设计要考虑可测试性

# 如何了解一个软件的设计
- 先模型、再接口、最后是实现。
- 理解模型的关键在于：要了解此模型设计的来龙去脉，提供了哪些能力，知道它如何解决相应问题。
- 分析一个软件接口需要找到一条功能主线，并且关注它所引导的风格（怎样使用或怎样继续开发）。
- 了解软件实现需要从软件结构和关键技术着手。

# 语言的模型
- 学习编程语言就是学习不同编程语言提供的编程模型
语法都是语法糖（为方便程序员使用）

# 语言的接口
- 语言设计就是程序库设计，提升设计能力可以从编写程序库入手

# 语言实现-运行时
- 理解程序语言的运行时，吧运行时作为设计根基，能够不受限于语言

# DSL
- 领域特定语言
- 满足特定领域的也无需求，降低理解门槛
- 好的设计迈向DSL，从编写有表达性的代码起步

# 编程范式
- 结构化编程
- 面向对象编程
- 函数式编程
- 多范式编程：应用面向对象组织程序，在每个类的具体的接口设计上采用函数式编程风格，具体实现中使用结构化编程提供的控制结构

# 结构化编程
- 解决汇编指令goto跳转造成程序难以理解的问题
- 功能分解，拆分问题，使得程序易于理解
- 依赖关系太强，不能有效的隔离变化

# 面向对象-封装
- 封装要将意图和实现分离开来， 不要暴露实现细节（比如内部字段）
- 最小化接口暴露

# 面向对象继承
- 接口继承：一种代码复用方式，不鼓励
- 实现继承：与多态相关
- 组合优于继承

# 面向对象多态
- 面向接口编程
- 要找出变与不变的地方，用接口将其隔离开来
 
# 函数式编程
- 函数是一等公民
- 它可以按需创建
- 它可以存储在数据结构中
- 可以作为参数
- 可以作为返回值

# 函数式编程组合性
- 两大特性：**组合性**和**不变性**
- 使用高阶函数做行为组合
- 列表转换：**map**、**filter**和**reduce**

# 函数式编程不变性
- 普通函数隐式改变变量值导致bug
- 值确保不会显示改变一个量
- 纯函数确保不会隐式改变一个量
- 尽量编写不变类和纯函数

# 函数式编程拾遗
- 惰性求值
- 无限流
- Optional

# 单一职责原则
- 一个模块应该对一类且仅对一类行为负责，不仅要考虑变化，还要考虑变化的来源
- 一个模块理想的状态是不改变，其次是少改变
- 理解分离关注点

# 开放封闭原则
- 软件实体应该对扩展开放，对修改封闭
- 设计扩展点，每一个扩展点都是需要设计的模型
- 构建模型

# Liskov替换原则
- 子类型必须能够替换父类型
- 运行时类型识别的代码很可能破坏LSP原则
- 如果A是B的子类，就需要满足A is a B

# 接口隔离原则
- 不应该强迫使用者依赖于他们不用的接口
- 识别不同的对象，设计小接口

# 依赖倒置原则
- 高层模块不应依赖于底层模块，二者依赖于抽象
- 抽象不依赖于细节，细节依赖于抽象

# 设计模式
- 以设计原则为基础，设计模式只是设计原则在特定场景下的应用
- 不局限于模式，设计模式也会随着语言的发展而变化

# 简单设计
- **KISS原则**， Keep it simple, stupid
- **YAGNI**，You aren't gonna need it
- **DRY**，Don't repeat yourself
- 通过所有测试
- 消除重复
- 表达出程序员的意图
- 让类和方法的数量最小化

# 领域驱动设计（DDD）
- DDD的根基：通用语言和模型驱动的设计
## 通用语言
- 在业务人员和开发人员之间建立起一套共有的语言
- 事件风暴
1. 把领域事件识别出来
2. 找出这些动作（引发领域事件的命令）
3. 找出时间和命令相关的实体或聚合
## 模型驱动设计
- 战略设计：将系统拆分成不同的领域
- 战术设计：如何具体组织不同的业务模型

# 战略设计：如何划分系统模块
## 业务概念划分
将领域划分为若干子域，根据重要程度可以划分为：
- 核心域：系统最重要的部分
- 支撑域：不是核心竞争力，但不得不做且没有现成方案
- 通用域：不影响业务
## 解决方案
- 界限上下文：限定了模型的使用边界，将识别出的模型放到不同的界限上下文中
- 上下文映射图：定义不同上下文之间的交互方式（如防腐层），即定义出一些接口，使不同模型可以交互

# 战术设计：如何找出模型
找出不同的角色，找出不同角色之间的关系，让它们互动起来
## 角色：实体、值对象
- 实体：能够通过唯一标识符标识出来的对象
- 值对象：就表示一个值
## 关系：聚合和聚合根
把问题出发点放到业务上
- 聚合就是多个实体或值对象的组合
- 聚合根就是从外部访问这个聚合的起点
## 互动：工厂、仓库、领域服务、应用服务
- 领域服务操作领域对象，更准确的说，它操作的是聚合根
- 工厂其实就是设计模式中常提到的工厂
- 仓库将领域对象变更的结果保存起来
- 应用服务协调不同的领域对象、领域服务等完成客户端所要求的的各种业务动作

# 应用改进
- 找到改进的目标
- 理解系统需求，梳理接口
- 积少成多，从小模块开始改进